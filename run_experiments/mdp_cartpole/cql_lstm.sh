#!/bin/bash

# CQL-LSTM for CartPole-v1
python3 src/train.py \
--wandb.project-name=MATL-MDP-CartPole \
--wandb.wwandb=True \
--data.gamma=1.0 \
--data.path-to-dataset=data/MDP/CartPole-v1 \
--training.learning-rate=0.0003 \
--training.lr-end-factor=0.1 \
--training.beta-1=0.9 \
--training.beta-2=0.999 \
--training.weight-decay=0.01 \
--training.batch-size=256 \
--training.warmup-steps=100 \
--training.final-tokens=1000000 \
--training.grad-norm-clip=5.0 \
--training.epochs=100 \
--training.ckpt-epoch=10 \
--training.online-inference=True \
--training.log-last-segment-loss-only=False \
--training.use-cosine-decay=False \
--training.context-length=30 \
--training.sections=3 \
--model.env-name=CartPole-v1 \
--model.state-dim=4 \
--model.act-dim=2 \
--model.d-model=64 \
--model.dropout=0.2 \
--model.padding-idx=-10 \
--model.backbone=lstm \
--model.lstm_layers=1 \
--model.bidirectional=False \
--model.reset_hidden_state_batch=True \
--tensorboard-dir=runs/MDP/CartPole-v1/CQL_LSTM \
--model-mode=CQL \
--model.cql-alpha=5.0 \
--start-seed=1 \
--end-seed=3 \
--text=CQL_LSTM \
--online-inference.best_checkpoint_metric=mean_return \
--online-inference.episode-timeout=500 \
--online-inference.desired-return-1=500.0 \
--online-inference.use-argmax=True
