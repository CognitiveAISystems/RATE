#!/bin/bash

python3 src/train.py \
    --arch-mode=TrXL \
     --data.gamma=1 \
     --data.max-length=None \
     --data.path-to-dataset=data/MDP/CartPole-v1 \
     --end-seed=3 \
     --model-mode=RATE \
     --model.act-dim=2 \
     --model.d-head=128 \
     --model.d-inner=128 \
     --model.d-model=128 \
     --model.dropatt=0 \
     --model.dropout=0.2 \
     --model.env-name=CartPole-v1 \
     --model.ext-len=0 \
     --model.mem-at-end=True \
     --model.mem-len=0 \
     --model.mrv-act=relu \
     --model.n-head=4 \
     --model.n-head-ca=2 \
     --model.n-layer=4 \
     --model.num-mem-tokens=15 \
     --model.padding-idx=-10 \
     --model.skip-dec-ffn=True \
     --model.state-dim=4 \
     --online-inference.best_checkpoint_metric=mean_return \
     --online-inference.episode-timeout=500 \
     --online-inference.desired-return-1=500.0 \
     --online-inference.use-argmax=True \
     --start-seed=1 \
     --tensorboard-dir=runs/MDP/CartPole-v1/RATE \
     --text=RATE \
     --training.batch-size=256 \
     --training.beta-1=0.9 \
     --training.beta-2=0.999 \
     --training.ckpt-epoch=1 \
     --training.context-length=30 \
     --training.epochs=5 \
     --training.final-tokens=1000000 \
     --training.grad-norm-clip=1 \
     --training.learning-rate=0.0003 \
     --training.log-last-segment-loss-only=True \
     --training.lr-end-factor=0.01 \
     --training.online-inference=True \
     --training.sections=3 \
     --training.use-cosine-decay=False \
     --training.warmup-steps=1000 \
     --training.weight-decay=0.01 \
     --wandb.project-name=MATL-MDP-CartPole \
     --wandb.wwandb=True